openapi: 3.0.0
info:
  title: INN-Reach API
  version: v1
servers:
  - url: /inn-reach/
paths:
  /central-servers/{centralServerId}/material-type-mappings:
    get:
      description: Get a list of material type mappings for the given central server
      operationId: getMaterialTypeMappingsByServerId
      tags:
        - material-type-mappings
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingsDTO"
        '400':
          description:
            Bad request, e.g. malformed request body or query parameter.
            Details of the error (e.g. name of the parameter or line/character number
            with malformed data) provided in the response.
          content:
            application/json:
              example:
                $ref: "#/components/examples/error"
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
    post:
      description: Add new material type mapping associated with the central server
      operationId: postMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '201':
          description: Material type mapping created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingDTO"
        '400':
          description: Bad request
          content:
            application/json:
              example:
                $ref: "#/components/examples/error"
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
                example: Internal server error
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/materialTypeMappingDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
  /central-servers/{centralServerId}/material-type-mappings/{id}:
    get:
      description: Get material type mapping by id
      operationId: getMaterialTypeMappingById
      tags:
        - material-type-mappings
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingDTO"
        '404':
          description: Material type mapping not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
    put:
      description: Update material type mapping
      operationId: updateMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingDTO"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '404':
          description: Material type mapping not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/materialTypeMappingDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
    delete:
      description: Delete material type mapping
      operationId: deleteMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '204':
          description: No content
        '404':
          description: Material type mapping not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
  /locations:
    post:
      description: Add new InnReach location
      operationId: postInnReachLocation
      tags:
        - locations
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationDTO"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/innReachLocationDTO"
        required: true
    get:
      description: Get a list of InnReach locations
      operationId: getLocations
      tags:
        - locations
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationsDTO"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
  /locations/{locationId}:
    get:
      description: Get InnReach location by id
      operationId: getLocationById
      tags:
        - locations
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationDTO"
        '404':
          description: InnReach location not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: '#/components/parameters/id'
    put:
      description: Update InnReach location
      operationId: updateLocation
      tags:
        - locations
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationDTO"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '404':
          description: InnReach location not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/innReachLocationDTO"
        required: true
      parameters:
        - $ref: '#/components/parameters/id'
    delete:
      description: Delete InnReach location
      operationId: deleteLocation
      tags:
        - locations
      responses:
        '204':
          description: No content
        '404':
          description: InnReach location not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      parameters:
        - $ref: '#/components/parameters/id'
  /central-servers/contribution-criteria:
    post:
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contributionCriteriaDTO"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      description: Create new contribution criteria for Central Server
      operationId: postContributionCriteria
      tags:
        - contributionCriteria
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contributionCriteriaDTO"
        required: true
  /central-servers/{centralServerId}/contribution-criteria:
    delete:
      responses:
        '204':
          description: No content
        '404':
          description: Contribution Criteria not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      description: Delete Contribution Criteria Configuration
      operationId: deleteCriteria
      tags:
        - contributionCriteria
      parameters:
        - $ref: '#/components/parameters/id'
    get:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contributionCriteriaDTO"
        '404':
          description: Contribution criteria not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      description: Get Contribution Criteria by id
      operationId: getCriteriaById
      tags:
        - contributionCriteria
      parameters:
        - $ref: '#/components/parameters/id'
    put:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contributionCriteriaDTO"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '404':
          description: InnReach location not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      description: Update Contribution Criteria Configuration
      operationId: updateCriteria
      tags:
        - contributionCriteria
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contributionCriteriaDTO"
      parameters:
        - $ref: '#/components/parameters/id'
  /authentication:
    post:
      description: Authenticate InnReach local server key/secret pair
      operationId: authenticateLocalServerKeySecret
      tags:
        - authentication
      responses:
        '200':
          description: OK
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/authenticationRequest"
        required: true
components:
  schemas:
    UUID:
      type: string
      format: uuid
    innReachLocationDTO:
      $ref: schemas/innReachLocationDTO.json
    innReachLocationsDTO:
      $ref: schemas/innReachLocationsDTO.json
    contributionCriteriaDTO:
      $ref: schemas/contributionCriteriaDTO.json
    validationErrorsDTO:
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
        validationErrors:
          type: array
          items:
            $ref: schemas/validationErrorDTO.json
    materialTypeMappingDTO:
      $ref: schemas/materialTypeMappingDTO.json
    materialTypeMappingsDTO:
      $ref: schemas/materialTypeMappingsDTO.json
    error:
      $ref: schemas/error.json
    authenticationRequest:
      $ref: schemas/authenticationRequest.json
  parameters:
    id:
      name: id
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/UUID"
    centralServerId:
      name: centralServerId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/UUID"
    trait_queryable_query:
      name: query
      in: query
      description: A query string to filter rules based on matching criteria in fields.
      schema:
        type: string
    trait_pageable_offset:
      name: offset
      in: query
      description: Skip over a number of elements by specifying an offset value for the query
      schema:
        default: 0
        minimum: 0
        maximum: 2147483647
        type: integer
    trait_pageable_limit:
      name: limit
      in: query
      description: Limit the number of elements returned in the response
      schema:
        default: 10
        minimum: 0
        maximum: 2147483647
        type: integer
  examples:
    error:
      value:
        $ref: examples/error.sample
