openapi: 3.0.0
info:
  title: INN-Reach API
  version: v1
servers:
  - url: /inn-reach/
paths:
  /central-servers:
    post:
      tags:
        - central-servers
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/centralServerDTO"
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Add new central server
      operationId: postCentralServer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/centralServerDTO"
        required: true
    get:
      tags:
        - central-servers
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/centralServersDTO"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Get a list of central servers
      operationId: getCentralServers
      parameters:
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
  /central-servers/{centralServerId}:
    get:
      tags:
        - central-servers
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/centralServerDTO"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Get central server by id
      operationId: getCentralServerById
      parameters:
        - $ref: '#/components/parameters/id'
    put:
      tags:
        - central-servers
      responses:
        '204':
          description: No content
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Update central server
      operationId: updateCentralServer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/centralServerDTO"
        required: true
      parameters:
        - $ref: '#/components/parameters/id'
    delete:
      tags:
        - central-servers
      responses:
        '204':
          description: No content
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Delete central server
      operationId: deleteCentralServer
      parameters:
        - $ref: '#/components/parameters/id'
  /central-servers/{centralServerId}/material-type-mappings:
    get:
      description: Get a list of material type mappings for the given central server
      operationId: getMaterialTypeMappingsByServerId
      tags:
        - material-type-mappings
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingsDTO"
        '400':
          $ref: "#/components/responses/trait_response_malformed_query_400"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
    post:
      description: Add new material type mapping associated with the central server
      operationId: postMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '201':
          description: Material type mapping created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingDTO"
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/materialTypeMappingDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
    put:
      description: >-
        Update (replace) the entire collection of material type mappings
        associated with the central server
      operationId: updateMaterialTypeMappings
      tags:
        - material-type-mappings
      responses:
        '204':
          description: Collection successfully updated
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/materialTypeMappingsDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
  /central-servers/{centralServerId}/material-type-mappings/{id}:
    get:
      description: Get material type mapping by id
      operationId: getMaterialTypeMappingById
      tags:
        - material-type-mappings
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/materialTypeMappingDTO"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
    put:
      description: Update material type mapping
      operationId: updateMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '204':
          description: No content
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/materialTypeMappingDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
    delete:
      description: Delete material type mapping
      operationId: deleteMaterialTypeMapping
      tags:
        - material-type-mappings
      responses:
        '204':
          description: No content
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/id"
  /locations:
    post:
      description: Add new InnReach location
      operationId: postInnReachLocation
      tags:
        - locations
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationDTO"
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/innReachLocationDTO"
        required: true
    get:
      description: Get a list of InnReach locations
      operationId: getLocations
      tags:
        - locations
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationsDTO"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
  /locations/{locationId}:
    get:
      description: Get InnReach location by id
      operationId: getLocationById
      tags:
        - locations
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/innReachLocationDTO"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: '#/components/parameters/id'
    put:
      description: Update InnReach location
      operationId: updateLocation
      tags:
        - locations
      responses:
        '204':
          description: No content
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/innReachLocationDTO"
        required: true
      parameters:
        - $ref: '#/components/parameters/id'
    delete:
      description: Delete InnReach location
      operationId: deleteLocation
      tags:
        - locations
      responses:
        '204':
          description: No content
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: '#/components/parameters/id'
  /central-servers/{centralServerId}/libraries/location-mappings/:
    get:
      description: Get a list of library to Inn-Reach location mappings for the given central server
      operationId: getLibraryMappingsByServerId
      tags:
        - library-mappings
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/libraryMappingsDTO"
        '400':
          $ref: "#/components/responses/trait_response_malformed_query_400"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
    put:
      description: >-
          Update (replace) the entire collection of library to Inn-Reach location mappings
          associated with the central server
      operationId: putLibraryMappings
      tags:
        - library-mappings
      responses:
        '204':
          description: Collection successfully updated
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/libraryMappingsDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
  /central-servers/{centralServerId}/libraries/{libraryId}/locations/location-mappings/:
    get:
      description: Get a list of library location to Inn-Reach location mappings for the given central server
      operationId: getLocationMappingsByServerId
      tags:
        - location-mappings
      responses:
        '200':
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/locationMappingsDTO"
        '400':
          $ref: "#/components/responses/trait_response_malformed_query_400"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/libraryId"
        - $ref: "#/components/parameters/trait_pageable_offset"
        - $ref: "#/components/parameters/trait_pageable_limit"
    put:
      description: >-
        Update (replace) the entire collection of library location to Inn-Reach location mappings
        associated with the central server
      operationId: putLocationMappings
      tags:
        - location-mappings
      responses:
        '204':
          description: Collection successfully updated
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/locationMappingsDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
        - $ref: "#/components/parameters/libraryId"
  /central-servers/{centralServerId}/contribution-criteria:
    get:
      description: Get Contribution Criteria by Central Server id
      operationId: getCriteriaByServerId
      tags:
        - contribution-criteria
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contributionCriteriaDTO"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
    post:
      description: Create new contribution criteria for Central Server
      operationId: postContributionCriteria
      tags:
        - contribution-criteria
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/contributionCriteriaDTO"
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contributionCriteriaDTO"
        required: true
      parameters:
        - $ref: "#/components/parameters/centralServerId"
    delete:
      description: Delete Contribution Criteria Configuration
      operationId: deleteCriteria
      tags:
        - contribution-criteria
      responses:
        '204':
          description: No content
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
    put:
      description: Update Contribution Criteria Configuration
      operationId: updateCriteria
      tags:
        - contribution-criteria
      responses:
        '204':
          description: No content
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '409':
          $ref: "#/components/responses/trait_response_409"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contributionCriteriaDTO"
      parameters:
        - $ref: "#/components/parameters/centralServerId"
  /authentication:
    post:
      description: Authenticate InnReach local server key/secret pair
      operationId: authenticateLocalServerKeySecret
      tags:
        - authentication
      responses:
        '200':
          description: OK
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/validationErrorsDTO"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/authenticationRequest"
        required: true
  /central-servers/{centralServerId}/item-contribution-options:
    get:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/itemContributionOptionsConfigurationDTO"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Get Item Contribution Options Configuration by id
      operationId: getItemContributionOptionsConfigurationById
      tags:
        - item-contribution-options-configuration
      parameters:
        - $ref: '#/components/parameters/centralServerId'
    put:
      responses:
        '204':
          description: No content
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '404':
          $ref: "#/components/responses/trait_response_404"
        '500':
          $ref: "#/components/responses/trait_response_500"
      description: Update Item Contribution Options Configuration
      operationId: updateItemContributionOptionsConfiguration
      tags:
        - item-contribution-options-configuration
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/itemContributionOptionsConfigurationDTO"
      parameters:
        - $ref: '#/components/parameters/centralServerId'
    post:
      description: Add new item contribution options configuration associated with the central server
      operationId: createItemContributionOptionsConfiguration
      tags:
        - item-contribution-options-configuration
      responses:
        '201':
          description: Item Contribution Options Configuration created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/itemContributionOptionsConfigurationDTO"
        '400':
          $ref: "#/components/responses/trait_response_validation_400"
        '500':
          $ref: "#/components/responses/trait_response_500"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/itemContributionOptionsConfigurationDTO"
        required: true
      parameters:
        - $ref: '#/components/parameters/centralServerId'
components:
  schemas:
    UUID:
      type: string
      format: uuid
    centralServerDTO:
      $ref: schemas/centralServerDTO.json
    centralServersDTO:
      $ref: schemas/centralServersDTO.json
    innReachLocationDTO:
      $ref: schemas/innReachLocationDTO.json
    innReachLocationsDTO:
      $ref: schemas/innReachLocationsDTO.json
    contributionCriteriaDTO:
      $ref: schemas/contributionCriteriaDTO.json
    validationErrorsDTO:
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
        validationErrors:
          type: array
          items:
            $ref: schemas/validationErrorDTO.json
    materialTypeMappingDTO:
      $ref: schemas/materialTypeMappingDTO.json
    materialTypeMappingsDTO:
      $ref: schemas/materialTypeMappingsDTO.json
    libraryMappingsDTO:
      $ref: schemas/libraryMappingsDTO.json
    locationMappingsDTO:
      $ref: schemas/locationMappingsDTO.json
    error:
      $ref: schemas/error.json
    authenticationRequest:
      $ref: schemas/authenticationRequest.json
    itemContributionOptionsConfigurationDTO:
      $ref: schemas/itemContributionOptionsConfigurationDTO.json
  parameters:
    id:
      name: id
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/UUID"
    centralServerId:
      name: centralServerId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/UUID"
    libraryId:
      name: libraryId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/UUID"
    trait_queryable_query:
      name: query
      in: query
      description: A query string to filter rules based on matching criteria in fields.
      schema:
        type: string
    trait_pageable_offset:
      name: offset
      in: query
      description: Skip over a number of elements by specifying an offset value for the query
      schema:
        default: 0
        minimum: 0
        maximum: 2147483647
        type: integer
    trait_pageable_limit:
      name: limit
      in: query
      description: Limit the number of elements returned in the response
      schema:
        default: 10
        minimum: 0
        maximum: 2147483647
        type: integer
  responses:
    trait_response_500:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/error"
    trait_response_409:
      description: Item state conflict
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/error"
    trait_response_404:
      description: Item not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/error"
    trait_response_validation_400:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/validationErrorsDTO"
    trait_response_malformed_query_400:
      description: Bad request, e.g. malformed query parameter.
      content:
        application/json:
          example:
            $ref: "#/components/examples/error"
          schema:
            $ref: "#/components/schemas/error"
  examples:
    error:
      value:
        $ref: examples/error.sample
